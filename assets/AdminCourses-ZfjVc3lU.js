import{u as L,x as I,a as D,m as V,M as F,_ as T,o as i,c as l,b as s,t as m,l as r,q as g,v as B,F as _,i as b,n as k,p as M,O as E,j as w,h as f,d as U,r as x}from"./index-JMiZhtTs.js";import{g as v}from"./GetDataStore-1lL8kNw0.js";import{A as O}from"./AlertStore-xYysMQKO.js";import{P}from"./PaginationComponent--wk0ROPf.js";import{f as R}from"./flatpickr-AUYHLChs.js";import"./sweetalert2.all-K1diHBhV.js";const A="https://vue3-course-api.hexschool.io/v2/",S="gymplus",{alertStyles:u,basicContent:h}=O(),y=L("adminCourseStore",{state:()=>({temp:{title:"",category:"",origin_price:null,price:null,description:"",content:"",is_enabled:0,imageUrl:"",imagesUrl:[],time:"","time-unix":0,difficulty:"",target:[],coach:"",unit:"堂"},fileInfo:null,isEditingCourse:!1,isAddingImg:!1}),actions:{getCourse(t){const e=v().targetData.find(c=>c.id===t);Object.keys(e).forEach(c=>{this.temp[c]=e[c]})},resetTemp(){this.$reset()},editCourse(t,e){this.isEditingCourse=!this.isEditingCourse,this.temp.is_enabled=parseInt(this.temp.is_enabled,10),this.temp["time-unix"]=new Date(this.temp.time).getTime()/1e3;const n={data:{...this.temp}};let c="post";t&&(c="put"),I[c](`${A}/api/${S}/admin/product${t?`/${t}`:""}`,n).then(a=>{u.basic.fire({...h(a.data.message,1),didClose:()=>{this.resetTemp(),this.isEditingCourse=!this.isEditingCourse,e.hide()}}),v().getRemoteData("products",1,!1)}).catch(a=>{this.isEditingCourse=!this.isEditingCourse,u.basic.fire(h(`錯誤${a.response.status}，請洽客服`,2))})},delCourse(t,e){this.isEditingCourse=!this.isEditingCourse,I.delete(`${A}/api/${S}/admin/product/${t}`).then(n=>{u.basic.fire({...h(n.data.message,1),didClose:()=>{this.resetTemp(),this.isEditingCourse=!this.isEditingCourse,e.hide()}}),v().getRemoteData("products",1,!1)}).catch(n=>{this.isEditingCourse=!this.isEditingCourse,u.basic.fire(h(`錯誤${n.response.status}，請洽客服`,2))})},getImgFile(t){const e=t.target.files[0],n=new FormData;n.append("file-to-upload",e),this.fileInfo=n},uploadImg(t,e){this.isAddingImg=!this.isAddingImg,I.post(`${A}/api/${S}/admin/upload`,this.fileInfo).then(n=>{const{imageUrl:c}=n.data;t?this.temp.imagesUrl.push(c):this.temp.imageUrl=c,u.basic.fire(h("新增成功",1));const a=e;a.value=null,this.isAddingImg=!this.isAddingImg}).catch(n=>{this.isAddingImg=!this.isAddingImg,this.fileInfo===null?u.basic.fire(h("請選擇檔案",2)):u.basic.fire(h(`錯誤${n.response.status}，請洽客服`,2))})}}}),j={data(){return{isImgArr:!1,categories:["瑜珈","有氧運動","重量訓練"],coachs:["Emma","Alex","Dhalsim","Olivia Chang","Jackson Liu"],targets:["年長者","初學者","親子","進階","健力","復健","體態維持"],isAddingToCart:!1,editModal:{},dateDom:null}},methods:{...D(y,["getCourse","resetTemp","editCourse","getImgFile","uploadImg"])},computed:{...V(y,["temp","isEditingCourse","isAddingImg"]),checkedtargets(){return this.targets.map(t=>{const e=this.temp.target;let n=!1;return e&&e.forEach(c=>{c===t&&(n=!0)}),n})}},mounted(){this.editModal=new F(this.$refs.courseEditModal),this.editModal["_element"].addEventListener("hidden.bs.modal",()=>{this.resetTemp()}),this.dateDom=this.$refs.dueDate,R(this.dateDom,{minDate:"today",wrap:!0})}},q={ref:"courseEditModal",class:"modal fade",id:"courseEditModal",tabindex:"-1","aria-labelledby":"courseEditModalLabel","aria-hidden":"true"},z={class:"modal-dialog modal-xl modal-dialog-scrollable"},J={class:"modal-content"},G={class:"modal-header bg-linear py-3"},H={class:"modal-title fs-6 fs-sm-5 fw-medium text-white",id:"productModal"},K={class:"modal-body p-5 px-xl-6"},Q={class:"container-fluid"},W={class:"row admin-form gx-6"},X={class:"col-lg-7 mb-3 mb-lg-0"},Y={class:"row g-3"},Z={class:"col-xl-6"},ss={class:"row g-1 align-items-center"},ts=s("label",{for:"title",class:"col-2 col-xl-3 form-label"},"課程標題",-1),es={class:"col"},os={class:"col-xl-6"},is={class:"row g-1 align-items-center"},ls=s("label",{for:"category",class:"col-2 form-label"},"分類",-1),ns={class:"col"},as=s("option",{value:"",disabled:"",hidden:""},"選擇課程分類",-1),ds=["value"],cs={class:"col-xl-6"},rs={class:"row g-1 align-items-center",ref:"dueDate"},ms=s("label",{for:"time",class:"col-2 col-xl-3 form-label"},"上課日期",-1),ps={class:"col input-group input-group-sm"},us=s("button",{class:"btn btn-light",type:"button","data-toggle":""},[s("i",{class:"bi bi-calendar-plus"})],-1),hs=s("button",{class:"btn btn-outline-gray-4 rounded-end-1 text-dark",type:"button","data-clear":""},[s("i",{class:"bi bi-x-lg"})],-1),gs={class:"col-xl-6"},_s={class:"row g-1 align-items-center"},bs=s("label",{for:"coach",class:"col-2 form-label"},"教練",-1),fs={class:"col"},vs=s("option",{value:"",disabled:"",hidden:""},"選擇開課教練",-1),ys=["value"],$s={class:"col-xl-6"},Cs={class:"row g-1 align-items-center"},ws=s("label",{for:"origin_price",class:"col-2 form-label"},"原價",-1),ks={class:"col input-group input-group-sm"},Es=s("span",{class:"input-group-text fs-8",style:{"letter-spacing":"0px"}},"NTD",-1),Ds={class:"col-xl-6"},Is={class:"row g-1 align-items-center"},Ms=s("label",{for:"price",class:"col-2 form-label"},"售價",-1),Us={class:"col input-group input-group-sm"},xs=s("span",{class:"input-group-text",style:{"letter-spacing":"0px"}},"NTD",-1),As=s("hr",{class:"mt-5"},null,-1),Ss={class:"col-md-12 mt-2"},Vs={class:"row g-1"},Ts=s("label",{class:"col-3 col-md-2 form-label",style:{"padding-top":"2px"}}," 推薦對象 ",-1),Bs={class:"col d-flex flex-wrap"},Fs=["checked","value","onUpdate:modelValue","id"],Ns=["for"],Ls=s("hr",{class:"mt-5 mb-2"},null,-1),Os={class:"col-md-12"},Ps={class:"row g-1 align-items-center"},Rs=s("label",{for:"content",class:"col-3 col-md-2 form-label"},"課程簡述",-1),js={class:"col"},qs={class:"col-md-12"},zs={class:"row g-1"},Js=s("label",{for:"description",class:"col-3 col-md-2 form-label"},"課程描述",-1),Gs={class:"col"},Hs={class:"col-lg-5 d-flex flex-column"},Ks=s("label",{for:"img",class:"form-label mb-2"},"課程圖片",-1),Qs={class:"position-relative mb-2",style:{height:"180px"}},Ws=["src"],Xs={class:"img-mask d-flex border"},Ys={key:0,class:"mx-auto my-auto"},Zs=s("span",{class:"icon-base icon-trash icon-sm"},null,-1),st=[Zs],tt={class:"row g-2 mb-4"},et={class:"position-relative"},ot=["src","alt"],it=s("div",{class:"img-mask"},null,-1),lt=["onClick"],nt=s("span",{class:"icon-base icon-trash icon-sm"},null,-1),at=[nt],dt={class:"form-check form-switch mb-2"},ct={class:"form-label",for:"imageSwitch"},rt={class:"input-group input-group-sm"},mt=["disabled"],pt={key:0,class:"line-loading-loop bg-white"},ut={key:1},ht={class:"mt-auto ms-md-auto"},gt={class:"form-check mt-5"},_t=s("label",{for:"is_enabled",class:"form-label"},"上架課程",-1),bt={class:"modal-footer border-0 shadow shadow-top"},ft=s("button",{type:"button",class:"btn btn-sm btn-outline-gray-3 flex-grow-1 flex-lg-grow-0 me-2","data-bs-dismiss":"modal"}," 關閉視窗 ",-1),vt=["disabled"],yt={class:"line-loading-loop bg-white"};function $t(t,e,n,c,a,$){return i(),l("div",q,[s("div",z,[s("div",J,[s("div",G,[s("h3",H,m(t.temp.id?"編輯課程":"新增課程"),1)]),s("div",K,[s("div",Q,[s("form",W,[s("div",X,[s("div",Y,[s("div",Z,[s("div",ss,[ts,s("div",es,[r(s("input",{type:"text",id:"title",class:"form-control form-control-sm",placeholder:"請輸入標題","onUpdate:modelValue":e[0]||(e[0]=o=>t.temp.title=o)},null,512),[[g,t.temp.title]])])])]),s("div",os,[s("div",is,[ls,s("div",ns,[r(s("select",{class:"form-select form-select-sm",id:"category","onUpdate:modelValue":e[1]||(e[1]=o=>t.temp.category=o)},[as,(i(!0),l(_,null,b(a.categories,o=>(i(),l("option",{value:o,key:o},m(o),9,ds))),128))],512),[[B,t.temp.category]])])])]),s("div",cs,[s("div",rs,[ms,s("div",ps,[r(s("input",{type:"text",id:"time",class:"form-control",placeholder:"請輸入上課日期","onUpdate:modelValue":e[2]||(e[2]=o=>t.temp.time=o),"data-input":""},null,512),[[g,t.temp.time]]),us,hs])],512)]),s("div",gs,[s("div",_s,[bs,s("div",fs,[r(s("select",{class:"form-select form-select-sm",id:"coach","onUpdate:modelValue":e[3]||(e[3]=o=>t.temp.coach=o)},[vs,(i(!0),l(_,null,b(a.coachs,o=>(i(),l("option",{value:o,key:o},m(o),9,ys))),128))],512),[[B,t.temp.coach]])])])]),s("div",$s,[s("div",Cs,[ws,s("div",ks,[Es,r(s("input",{type:"number",id:"origin_price",class:"form-control form-control-sm",placeholder:"請輸入原價","onUpdate:modelValue":e[4]||(e[4]=o=>t.temp.origin_price=o),min:"0"},null,512),[[g,t.temp.origin_price,void 0,{number:!0}]])])])]),s("div",Ds,[s("div",Is,[Ms,s("div",Us,[xs,r(s("input",{type:"number",id:"price",class:"form-control form-control-sm",placeholder:"請輸入售價","onUpdate:modelValue":e[5]||(e[5]=o=>t.temp.price=o),min:"0"},null,512),[[g,t.temp.price,void 0,{number:!0}]])])])]),As,s("div",Ss,[s("div",Vs,[Ts,s("div",Bs,[(i(!0),l(_,null,b(a.targets,(o,p)=>(i(),l("div",{class:k(["form-check me-2",{"mb-0":p>4}]),key:o},[r(s("input",{class:"form-check-input",checked:$.checkedtargets[p],value:o,"onUpdate:modelValue":C=>t.temp.target=C,type:"checkbox",id:`target${p}`},null,8,Fs),[[M,t.temp.target]]),s("label",{class:"form-label",for:`target${p}`},m(o),9,Ns)],2))),128))])])]),Ls,s("div",Os,[s("div",Ps,[Rs,s("div",js,[r(s("input",{type:"text",id:"content",class:"form-control form-control-sm",placeholder:"請輸入課程簡述","onUpdate:modelValue":e[6]||(e[6]=o=>t.temp.content=o)},null,512),[[g,t.temp.content]])])])]),s("div",qs,[s("div",zs,[Js,s("div",Gs,[r(s("textarea",{id:"description",class:"form-control form-control-sm",placeholder:"請輸入課程描述",style:{height:"157px"},"onUpdate:modelValue":e[7]||(e[7]=o=>t.temp.description=o)},null,512),[[g,t.temp.description]])])])])])]),s("div",Hs,[Ks,s("div",Qs,[t.temp.imageUrl?r((i(),l("img",{key:0,src:t.temp.imageUrl,alt:"主要圖片",class:"img-fluid w-100 h-100 rounded-2"},null,8,Ws)),[[E,t.temp.imageUrl]]):w("",!0),s("div",Xs,[t.temp.imageUrl?w("",!0):(i(),l("p",Ys,"缺少主要圖片"))]),t.temp.imageUrl?(i(),l("button",{key:1,type:"button",class:"admin-img-delBtn btn btn-outline-danger btn-sm position-absolute",style:{top:"8px",right:"8px"},onClick:e[8]||(e[8]=o=>t.temp.imageUrl="")},st)):w("",!0)]),s("div",tt,[t.temp.imagesUrl?(i(!0),l(_,{key:0},b(t.temp.imagesUrl,(o,p)=>(i(),l("div",{class:"col-4",key:p},[s("div",et,[r(s("img",{src:o,alt:"新增圖片"+(p+1),class:"w-100 rounded-2",style:{height:"100px"}},null,8,ot),[[E,o]]),it,s("button",{type:"button",class:"admin-img-delBtn btn btn-outline-danger btn-sm position-absolute",style:{top:"4px",right:"4px"},onClick:C=>t.temp.imagesUrl.splice(p,1)},at,8,lt)])]))),128)):w("",!0)]),s("div",dt,[r(s("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"imageSwitch","onUpdate:modelValue":e[9]||(e[9]=o=>a.isImgArr=o)},null,512),[[M,a.isImgArr]]),s("label",ct,m(a.isImgArr?"新增到圖片集":"更新主要圖片"),1)]),s("div",rt,[s("input",{type:"file",id:"img",ref:"fileInput",class:"form-control form-control-sm",onChange:e[10]||(e[10]=(...o)=>t.getImgFile&&t.getImgFile(...o))},null,544),s("button",{class:"btn btn-outline-gray-3 ls-2",type:"button",onClick:e[11]||(e[11]=o=>t.uploadImg(a.isImgArr,t.$refs.fileInput)),disabled:t.isAddingImg},[t.isAddingImg?(i(),l("span",pt)):(i(),l("span",ut,"新增圖片"))],8,mt)]),s("div",ht,[s("div",gt,[r(s("input",{type:"checkbox",id:"is_enabled",class:"form-check-input","onUpdate:modelValue":e[12]||(e[12]=o=>t.temp.is_enabled=o),"true-value":"1","false-value":"0"},null,512),[[M,t.temp.is_enabled]]),_t])])])])])]),s("div",bt,[ft,s("button",{type:"button",class:"btn btn-sm btn-gray-1 flex-grow-1 flex-lg-grow-0",onClick:e[13]||(e[13]=o=>t.editCourse(t.temp.id,a.editModal)),disabled:t.isEditingCourse},[r(s("span",yt,null,512),[[E,t.isEditingCourse]]),f(" "+m(t.temp.id?"更新課程":"新增課程"),1)],8,vt)])])])],512)}const Ct=T(j,[["render",$t]]),wt={data(){return{delModal:null}},methods:{...D(y,["delCourse"])},computed:{...V(y,["temp","isEditingCourse"])},mounted(){this.delModal=new F(this.$refs.courseDelModal)}},kt={class:"modal fade",ref:"courseDelModal",id:"courseDelModal",tabindex:"-1"},Et={class:"modal-dialog"},Dt={class:"modal-content"},It=s("div",{class:"modal-header bg-linear-danger py-3"},[s("h3",{class:"modal-title fs-6 fs-sm-5 fw-medium text-white"},"刪除課程")],-1),Mt={class:"modal-body p-5"},Ut={class:"container-fluid"},xt={class:"row"},At=s("h4",{class:"fs-6"},"確定要刪除課程？",-1),St={class:"col-sm-7"},Vt={class:"list-group list-group-flush small"},Tt={class:"list-group-item px-0"},Bt={class:"list-group-item px-0"},Ft={class:"ls-0"},Nt={class:"list-group-item px-0"},Lt={class:"ls-0"},Ot={class:"col-sm-5"},Pt={class:"position-relative mx-7 mx-sm-0",style:{height:"140px"}},Rt=["src","alt"],jt=s("div",{class:"img-mask"},null,-1),qt={class:"modal-footer border-0 shadow shadow-top"},zt=s("button",{type:"button",class:"btn btn-sm btn-outline-gray-3 flex-grow-1 flex-md-grow-0 me-2","data-bs-dismiss":"modal"}," 關閉視窗 ",-1),Jt=["disabled"],Gt={class:"line-loading-loop bg-white"};function Ht(t,e,n,c,a,$){return i(),l("div",kt,[s("div",Et,[s("div",Dt,[It,s("div",Mt,[s("div",Ut,[s("div",xt,[At,s("div",St,[s("ul",Vt,[s("li",Tt,"課程名稱："+m(t.temp.title),1),s("li",Bt,[f(" 課程編號： "),s("span",Ft,m(t.temp.id),1)]),s("li",Nt,[f(" 開課日期： "),s("span",Lt,m(t.temp.time),1)])])]),s("div",Ot,[s("div",Pt,[s("img",{src:t.temp.imageUrl,alt:t.temp.title,class:"img-fluid w-100 h-100 rounded-2"},null,8,Rt),jt])])])])]),s("div",qt,[zt,s("button",{type:"button",class:"btn btn-danger btn-sm flex-grow-1 flex-md-grow-0",onClick:e[0]||(e[0]=o=>t.delCourse(t.temp.id,a.delModal)),disabled:t.isEditingCourse},[r(s("span",Gt,null,512),[[E,t.isEditingCourse]]),f(" 確認刪除 ")],8,Jt)])])])],512)}const Kt=T(wt,[["render",Ht]]),Qt={components:{PaginationComponent:P,CourseEditModal:Ct,CourseDelModal:Kt},props:["haveToken"],data(){return{url:"",path:"",courses:[],pageInfo:{},badgeStyles:{yoga:"bg-primary bg-opacity-50",strength:"bg-gray-1 bg-opacity-50",cardio:"bg-secondary"},yoga:"bg-primary bg-opacity-50"}},methods:{...D(v,["getRemoteData"]),...D(y,["getCourse"]),chooseBadgeStyle(t){switch(t){case"瑜珈":return this.badgeStyles.yoga;case"重量訓練":return this.badgeStyles.strength;case"有氧運動":return this.badgeStyles.cardio;default:return""}}},computed:{...V(v,["targetData"])},watch:{targetData(t){this.courses=t}},mounted(){this.getRemoteData("products",1,!1)}},Wt={class:"container"},Xt=s("h2",{class:"fs-3 fw-normal ls-0 mb-md-0 text-center"},[s("span",null,"課程管理")],-1),Yt=s("div",{class:"text-center text-md-end mb-3"},[s("button",{type:"button",class:"btn btn-gray-3 py-1 shadow-sm","data-bs-toggle":"modal","data-bs-target":"#courseEditModal"},[s("span",{class:"icon-base icon-sm icon-add me-1 bg-white align-text-top"}),s("span",null,"新增課程")])],-1),Zt={key:0,class:"table-responsive mb-5"},se={class:"table table-hover text-center align-middle ls-0",style:{"min-width":"720px"}},te=s("thead",null,[s("tr",{class:"table-gray-4"},[s("th",{scope:"col",width:"52px"}),s("th",{scope:"col",class:"d-none d-lg-table-cell"},"縮圖"),s("th",{scope:"col"},"分類"),s("th",{scope:"col"},"標題"),s("th",{scope:"col"},"教練"),s("th",{scope:"col"},"上課時間"),s("th",{scope:"col"},"售價"),s("th",{scope:"col",width:"90px"},"開課狀況"),s("th",{scope:"col",width:"75px"})])],-1),ee=["onClick"],oe=s("span",{class:"icon-base icon-sm icon-trash"},null,-1),ie=[oe],le={class:"d-none d-lg-table-cell"},ne=["src","alt"],ae={class:"fs-7 fs-lg-6"},de={class:"small fs-lg-7 fw-normal mb-0"},ce={class:"fs-8 fs-lg-7"},re={class:"fs-8 fs-lg-7 ls-0"},me={class:"fw-semibold"},pe={class:"fs-7 fs-lg-6"},ue=["onClick"],he={key:1},ge=s("h2",{class:"fs-6 fw-light text-center"},[s("span",{class:"line-loading-loop bg-gray-3 align-top"}),f(" 資料讀取中請稍後 ")],-1),_e=[ge];function be(t,e,n,c,a,$){const o=x("PaginationComponent"),p=x("CourseEditModal"),C=x("CourseDelModal");return i(),l(_,null,[s("div",Wt,[Xt,Yt,a.courses.length!==0?(i(),l("div",Zt,[s("table",se,[te,s("tbody",null,[(i(!0),l(_,null,b(a.courses,d=>(i(),l("tr",{key:d.id},[s("td",null,[s("button",{type:"button",class:"btn btn-sm btn-outline-danger border-0 p-1","data-bs-toggle":"modal","data-bs-target":"#courseDelModal",onClick:N=>t.getCourse(d.id)},ie,8,ee)]),s("td",le,[s("img",{src:d.imageUrl,alt:d.title,style:{width:"120px",height:"80px"}},null,8,ne)]),s("td",null,[s("p",ae,[s("span",{class:k(["badge",$.chooseBadgeStyle(d.category)])},m(d.category),3)])]),s("td",null,[s("h3",de,m(d.title),1)]),s("td",ce,m(d.coach),1),s("td",re,m(d.time),1),s("td",me,[s("span",{class:k({"text-danger ":d.price<d.origin_price})},m(d.price),3)]),s("td",null,[s("p",pe,[s("span",{class:k(["badge",{"bg-success":d.is_enabled,"bg-danger":!d.is_enabled}])},m(d.is_enabled?"上架中":"已下架"),3)])]),s("td",null,[s("button",{type:"button",class:"btn btn-sm py-1 btn-outline-dark fw-normal","data-bs-toggle":"modal","data-bs-target":"#courseEditModal",onClick:N=>t.getCourse(d.id)}," 編輯 ",8,ue)])]))),128))])])])):(i(),l("div",he,_e)),U(o,{"now-target":"products","is-user":!1})]),U(p),U(C)],64)}const ke=T(Qt,[["render",be]]);export{ke as default};
