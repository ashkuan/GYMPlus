import{u as m,x as n}from"./index-d6ePCIf6.js";import{A as h}from"./AlertStore-t-u7Dtg6.js";import{g as d}from"./GetDataStore-85IatuIu.js";const g="https://vue3-course-api.hexschool.io/v2/",l="gymplus",{alertStyles:a,basicContent:o}=h(),f=m("adminCourseStore",{state:()=>({temp:{title:"",category:"",origin_price:null,price:null,description:"",content:"",is_enabled:0,imageUrl:"",imagesUrl:[],time:"","time-unix":0,difficulty:"",target:[],coach:"",unit:"堂"},fileInfo:null,isEditingCourse:!1,isAddingImg:!1}),actions:{getCourse(t){const e=d().targetData.find(s=>s.id===t);Object.keys(e).forEach(s=>{this.temp[s]=e[s]})},resetTemp(){this.$reset()},editCourse(t,e){this.isEditingCourse=!this.isEditingCourse,this.temp.is_enabled=parseInt(this.temp.is_enabled,10),this.temp["time-unix"]=new Date(this.temp.time).getTime()/1e3;const i={data:{...this.temp}};let s="post";t&&(s="put"),n[s](`${g}/api/${l}/admin/product${t?`/${t}`:""}`,i).then(r=>{a.basic.fire({...o(r.data.message,1),didClose:()=>{this.resetTemp(),this.isEditingCourse=!this.isEditingCourse,e.hide()}}),d().getRemoteData("products",1,!1)}).catch(r=>{this.isEditingCourse=!this.isEditingCourse,a.basic.fire(o(`錯誤${r.response.status}，請洽客服`,2))})},delCourse(t,e){this.isEditingCourse=!this.isEditingCourse,n.delete(`${g}/api/${l}/admin/product/${t}`).then(i=>{a.basic.fire({...o(i.data.message,1),didClose:()=>{this.resetTemp(),this.isEditingCourse=!this.isEditingCourse,e.hide()}}),d().getRemoteData("products",1,!1)}).catch(i=>{this.isEditingCourse=!this.isEditingCourse,a.basic.fire(o(`錯誤${i.response.status}，請洽客服`,2))})},getImgFile(t){const e=t.target.files[0],i=new FormData;i.append("file-to-upload",e),this.fileInfo=i},uploadImg(t,e){this.isAddingImg=!this.isAddingImg,n.post(`${g}/api/${l}/admin/upload`,this.fileInfo).then(i=>{const{imageUrl:s}=i.data;t?this.temp.imagesUrl.push(s):this.temp.imageUrl=s,a.basic.fire(o("新增成功",1));const r=e;r.value=null,this.isAddingImg=!this.isAddingImg}).catch(i=>{this.isAddingImg=!this.isAddingImg,this.fileInfo===null?a.basic.fire(o("請選擇檔案",2)):a.basic.fire(o(`錯誤${i.response.status}，請洽客服`,2))})}}});export{f as a};
